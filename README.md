# StrmTool for Emby

## 功能说明

- Emby插件，提取strm文件的媒体信息，补充完整的媒体信息并加速strm媒体文件的起播速度
- 为了播放器兼容性，强烈建议使用http模式的strm媒体文件
- 在emby4.8.11.0和4.9.1.80上通过测试

### 实时处理

- 当有新的strm文件入库时，自动提取媒体信息
- 实时响应媒体库变化，无需等待计划任务

### 兜底机制

- 原有的计划任务（每天凌晨3点）作为备份
- 确保所有strm文件都有完整的媒体信息
- 处理实时处理可能遗漏的文件

## 使用方法

1. 将`StrmTool.dll`放入Emby的插件目录
2. 重启Emby server
3. **自动注册**：插件启动时会自动注册事件处理器，开始实时处理新入库的strm文件
4. **无需配置**：无需额外开关或配置，实时处理功能默认启用
5. **兜底机制**：原有的计划任务仍然会在每天凌晨3点运行，作为兜底机制

## 工作流程

1. **实时处理**：当新的strm文件添加到媒体库时，立即提取媒体信息
2. **智能过滤**：只处理缺少完整媒体信息（视频流或音频流）的strm文件
3. **错误处理**：如果实时处理失败，会在日志中记录，并由计划任务后续处理
4. **兜底扫描**：每天凌晨3点扫描所有strm文件，确保没有遗漏，可自己在emby后台修改计划任务的时间

## 日志查看

可以在Emby的日志中查看插件运行状态：

- 事件处理器注册成功/失败信息
- 实时处理的文件信息
- 处理结果和可能的错误信息
