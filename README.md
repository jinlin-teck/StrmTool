# StrmTool for Emby

一款专为 Emby 媒体服务器设计的插件，用于优化 strm 文件的媒体信息管理和播放体验。

## 功能特性

### 🚀 媒体信息提取与加速

- **自动提取**：当新的 strm 文件入库时，自动解析音视频编码、章节、字幕、图片等媒体信息
- **智能处理**：仅处理缺少完整媒体信息的 strm 文件，避免重复操作
- **播放加速**：通过预提取媒体信息，显著提升 strm 文件的起播速度
- **兜底扫描**：内置计划任务（默认凌晨3点，可自定义）确保无遗漏

### 💾 备份与恢复

- **自动备份**：提取媒体信息后自动导出为 JSON 备份文件（自动跳过已有的同名json文件）
- **文件位置**：备份文件保存在 strm 文件同目录下，格式为 `{filename}-mediainfo.json`
- **一键恢复**：支持从 JSON 备份文件快速恢复媒体信息
- **智能检测**：恢复时自动识别需要处理的文件（缺少音视频信息的文件）

## 安装与使用

### 安装步骤

1. 将 `StrmTool.dll` 文件放入 Emby 插件目录
2. 重启 Emby 服务器
3. 插件将自动启用并开始工作

### 计划任务

在 Emby 管理后台的「计划任务」中可找到以下功能：

| 任务名称 | 功能说明 | 默认执行时间 |
|---------|---------|-------------|
| **提取 Strm 媒体信息** | 兜底扫描，确保所有 strm 文件信息完整 | 每天凌晨3点 |
| **导出 STRM 媒体信息** | 手动导出所有 strm 文件的媒体信息 | 手动执行 |
| **恢复 STRM 媒体信息** | 从 JSON 备份文件恢复媒体信息 | 手动执行 |

## 配置说明

- **实时处理**：默认启用，无需额外配置
- **计划任务**：可根据需求调整执行时间
- **备份策略**：自动备份，无需手动干预

## 系统要求

- **Emby 版本**：已在 4.8.11.0 和 4.9.1.80 版本测试通过，其他版本请自行测试
- **兼容性建议**：为获得最佳播放器兼容性，推荐使用 http 模式的 strm 媒体文件

## 注意事项

- 插件自动注册事件处理器，安装后立即生效
- 手动刷新媒体库可能导致已提取信息丢失，建议使用备份恢复功能
- 恢复功能仅在需要时手动执行，不会自动运行

---

**使用提示**：建议定期检查计划任务执行情况，确保媒体信息始终保持最新状态。
